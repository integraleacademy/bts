{% extends 'base.html' %}
{% block content %}
<h2>Administration</h2>

<div class="card">
  <form method="post" action="/admin/add" class="add-form">
    <input name="nom" placeholder="Nom" required>
    <input name="prenom" placeholder="Prénom" required>
    <button class="admin-btn">➕ Ajouter</button>
  </form>
</div>

<div class="card">
  <table class="admin-table">
    <thead>
      <tr>
        <th>Nom</th>
        <th>Prénom</th>
        <th>Status</th>
        <th>Commentaire</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for r in rows %}
      <tr>
        <td>{{r.nom}}</td>
        <td>{{r.prenom}}</td>
        <td>
          <span class="badge" style="background: {{ r.status|status_color }};">
            {{ r.status }}
          </span>
          <form method="post" action="/update/{{r.id}}" class="inline-form">
            <select name="status">
              {% for s in statuses %}
                <option value="{{s}}" {% if s == r.status %}selected{% endif %}>{{s}}</option>
              {% endfor %}
            </select>
            <button type="submit" class="admin-btn small">💾</button>
          </form>
        </td>
        <td>
          <form method="post" action="/update_comment/{{r.id}}" class="inline-form">
            <input type="text" name="commentaire" value="{{ r.commentaire or '' }}" placeholder="Ajouter un commentaire">
            <button type="submit" class="admin-btn small">💾</button>
          </form>
        </td>
        <td>
          <a class="admin-btn small" href="{{ url_for('edit', id=r.id) }}">✏️ Modifier</a>
          <form method="post" action="/delete/{{r.id}}" class="inline-form">
            <button type="submit" class="admin-btn small danger">🗑️ Supprimer</button>
          </form>
          <a class="admin-btn small" href="{{ url_for('fiche', id=r.id) }}">🖨️ Fiche</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
